Counter.DefaultCharacterSets={numericUp:'0123456789',numericDown:'9876543210',alphabeticUp:' ABCDEFGHIJKLMNOPQRSTUVWXYZ',alphabeticDown:'ZYXWVUTSRQPONMLKJIHGFEDCBA ',alphanumericUp:'0123456789 ABCDEFGHIJKLMNOPQRSTUVWXYZ',alphanumericDown:'9876543210ZYXWVUTSRQPONMLKJIHGFEDCBA ',calculator:'0123456789.,+-*/= ',qwertyKeybord:' QWERTYUIOPASDFGHJKLZXCVBNM1234567890-=[]\\;\',./~`!@#$%^&*()_+{}|:"<>?',allCharacters:' ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-=[]\\;\',./~`!@#$%^&*()_+{}|:"<>?'};Counter.ScrollDirection={Downwards:-1,Mixed:0,Upwards:1};Counter.ScrollAnimation={FixedTime:0,FixedSpeed:1,SlotMachine:2};function Counter(elementId,config){this.wrapper=document.getElementById(elementId);this.wrapperId=elementId;this.intervalTimerId=null;this.timeoutTimerId=null;this.isAnimating=false;this.animationStep=0.0;this.animationProgress=0.0;this.beforeAnimation=[];this.afterAnimation=[];this.itemAnimationProgress=[];this.digitsNumber=(config.digitsNumber||6);this.direction=(config.direction||Counter.ScrollDirection.Mixed);this.value=(config.value||0);this.decimalSeparator=(config.decimalSeparator||'.');this.thousandsSeparator=(config.thousandsSeparator||',');this.showDecimalSeparator=(config.showDecimalSeparator||false);this.showThousandsSeparator=(config.showThousandsSeparator||false);this.decimalPoints=(config.decimalPoints||(this.showDecimalSeparator?2:0));this.prefixText=(config.prefixText||'');this.postfixText=(config.postfixText||'');this.scrollAnimation=(config.scrollAnimation||Counter.ScrollAnimation.FixedTime);this.characterSet=(config.characterSet||Counter.DefaultCharacterSets.allCharacters);this.characterNumber=this.characterSet.length;this.animationDuration=(config.animationDuration||50);var tempClassNames=["wrapper","left","inner","right","marker"];this.extraClassName={};for(var i=0;i<tempClassNames.length;i++){if(!config.extraClassName){this.extraClassName[tempClassNames[i]]=""}else if(typeof config.extraClassName=="string"){this.extraClassName[tempClassNames[i]]=config.extraClassName}else{this.extraClassName[tempClassNames[i]]=(config.extraClassName[tempClassNames[i]]||"")}}this.onLoad=(config.onLoad||null);this.onValueChanged=(config.onValueChanged||null);var that=this;this.imageLoadCounter=0;this.charsImage=new Image();this.charsImage.onload=function(){that.finishLoading()};this.charsImage.src=config.charsImageUrl;this.markerImage=new Image();this.markerImage.onload=function(){that.finishLoading()};this.markerImage.src=config.markerImageUrl}Counter.prototype.finishLoading=function(){this.imageLoadCounter++;if(this.imageLoadCounter!=2||!this.charsImage.width||!this.markerImage.width)return;this.digitWidth=this.charsImage.width;this.digitHeight=Math.ceil(this.charsImage.height/this.characterNumber);this.offsetHeight=(this.markerImage.height-this.digitHeight)/2;this.makrer=document.createElement("DIV");this.makrer.className="counter_marker"+(this.extraClassName.marker?" ":"")+this.extraClassName.marker;this.makrer.style.backgroundImage="url('"+this.markerImage.src+"')";this.makrer.style.width=(this.digitWidth*this.digitsNumber+this.digitsNumber)+"px";this.makrer.style.height=this.markerImage.height+"px";this.wrapper.className=this.wrapper.className+(this.extraClassName.marker?" ":"")+this.extraClassName.marker;this.wrapper.style.width=this.makrer.style.width;this.wrapper.style.height=this.makrer.style.height;this.wrapper.appendChild(this.makrer);var i=0;totalWidth=0;if(this.prefixText!='')totalWidth+=this.createTextElement(this.prefixText,'prefix','counter_character_left');for(i=0;i<this.digitsNumber;i++){if(this.showDecimalSeparator&&this.decimalSeparator&&this.decimalPoints>0&&i==this.digitsNumber-this.decimalPoints)totalWidth+=this.createTextElement(this.decimalSeparator,'decimal','counter_character_inner');if(this.showThousandsSeparator&&this.thousandsSeparator&&this.decimalPoints>=0&&i>0&&i<this.digitsNumber-this.decimalPoints&&i%3==(this.digitsNumber-this.decimalPoints)%3)totalWidth+=this.createTextElement(this.thousandsSeparator,'thousand_'+i,'counter_character_inner');var temp=document.createElement("DIV");temp.id=this.wrapperId+"_"+i;temp.className="counter_character";if(i==0)temp.className+=(this.prefixText!=''?" counter_character_inner":" counter_character_left")+(this.extraClassName.left?" ":"")+this.extraClassName.left;else if(i==this.digitsNumber-1)temp.className+=(this.posfixText!=''?" counter_character_inner":" counter_character_right")+(this.extraClassName.right?" ":"")+this.extraClassName.right;else temp.className+=" counter_character_inner"+(this.extraClassName.inner?" ":"")+this.extraClassName.inner;temp.style.backgroundImage="url('"+this.charsImage.src+"')";temp.style.width=this.digitWidth+"px";temp.style.height=this.markerImage.height+"px";temp.style.top=(-this.markerImage.height)+"px";this.wrapper.appendChild(temp);totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"margin-left"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"margin-right"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"border-left-width"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"border-right-width"));totalWidth+=this.digitWidth}if(this.postfixText!='')totalWidth+=this.createTextElement(this.postfixText,'postfix','counter_character_right');this.makrer.style.width=totalWidth+"px";this.wrapper.style.width=totalWidth+"px";if(this.onLoad!=null)this.onLoad();this.setValue(this.value,100)};Counter.prototype.createTextElement=function(elementText,id,className){var totalWidth=0;var temp=document.createElement("DIV");temp.id=this.wrapperId+"_"+id;temp.className="counter_character counter_text "+className;temp.innerHTML=elementText;temp.style.width=(this.digitWidth)+"px";temp.style.height=this.markerImage.height+"px";temp.style.top=(-this.markerImage.height)+"px";this.wrapper.appendChild(temp);totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"margin-left"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"margin-right"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"border-left-width"));totalWidth+=Counter._parseInt(Counter._elementCurrentStyle(temp,"border-right-width"));totalWidth+=this.digitWidth;return totalWidth};Counter.prototype.animate=function(forceFinish){if(forceFinish){this.animationProgress=1.0}else{this.animationProgress+=this.animationStep}if(this.animationProgress>=1){this.animationProgress=1.0;if(this.timeoutTimerId)clearTimeout(this.timeoutTimerId);if(this.intervalTimerId)clearTimeout(this.intervalTimerId);this.isAnimating=false;this.timeoutTimerId=null;this.intervalTimerId=null}var i=0;var idPrefix=this.wrapper.id+"_";for(i=0;i<this.beforeAnimation.length;i++){var temp=document.getElementById(idPrefix+(this.digitsNumber-i-1));if(temp){var progress=0.0;if(this.animationProgress<1){if(this.scrollAnimation==Counter.ScrollAnimation.FixedSpeed){var tempProgress=this.animationProgress/(this.itemAnimationProgress[i]);if(tempProgress<1){progress=this.beforeAnimation[i]+(this.afterAnimation[i]-this.beforeAnimation[i])*tempProgress}else{progress=this.beforeAnimation[i]+(this.afterAnimation[i]-this.beforeAnimation[i])*1}}else if(this.scrollAnimation==Counter.ScrollAnimation.SlotMachine){progress=this.beforeAnimation[i]+(this.afterAnimation[i]-this.beforeAnimation[i])*(2*this.animationProgress-Math.pow(this.animationProgress,2))}else{progress=this.beforeAnimation[i]+(this.afterAnimation[i]-this.beforeAnimation[i])*this.animationProgress}}else{progress=this.afterAnimation[i]}var test=this;temp.style.backgroundPosition="0px "+Counter._parseInt(progress)+"px"}}};Counter.prototype.add=function(addValue,duration){this.setValue(parseFloat(this.value)+addValue,duration)};Counter.prototype.setValue=function(newValue,duration){if(this.imageLoadCounter!=2||!this.charsImage.width||!this.markerImage.width){this.value=newValue;if(this.onValueChanged!=null)this.onValueChanged();return}if(this.timeoutTimerId)clearTimeout(this.timeoutTimerId);if(this.intervalTimerId)clearTimeout(this.intervalTimerId);var i=0;var idPrefix=this.wrapper.id+"_";var beforeInx=[];this.beforeAnimation=[];this.afterAnimation=[];for(i=this.digitsNumber-1;i>=0;i--){var temp=document.getElementById(idPrefix+(this.digitsNumber-i-1));this.beforeAnimation[i]=new Number(temp.style.backgroundPosition.substr(4).replace("px",""))}var strCurrentValue=(this.value.toString?this.value.toString():new String(this.value));var strNextValue=(newValue.toString?newValue.toString():new String(newValue));if(this.showDecimalSeparator&&this.decimalSeparator&&this.decimalPoints>0){var decimalMultiplier=Math.pow(10,this.decimalPoints);var tempValue=Math.round(this.value*decimalMultiplier);var tempNextValue=Math.round(newValue*decimalMultiplier);var strCurrentValue=(tempValue.toString?tempValue.toString():new String(tempValue));var strNextValue=(tempNextValue.toString?tempNextValue.toString():new String(tempNextValue))}for(i=this.digitsNumber-1;i>=0;i--){var temp=document.getElementById(idPrefix+(this.digitsNumber-i-1));var current=-1;if(strCurrentValue.length-i-1>=0){var strCurrentChar=strCurrentValue.charAt(strCurrentValue.length-i-1).toUpperCase();current=this.characterSet.indexOf(strCurrentChar)}if(current==-1)current=this.characterSet.indexOf(" ");if(current==-1)current=this.characterSet.indexOf("0");if(current==-1)current=0;var next=-1;if(strNextValue.length-i-1>=0){var strNextChar=strNextValue.charAt(strNextValue.length-i-1).toUpperCase();next=this.characterSet.indexOf(strNextChar)}if(next==-1)next=this.characterSet.indexOf(" ");if(next==-1)next=this.characterSet.indexOf("0");if(next==-1)next=0;var test=this;this.afterAnimation[i]=Math.round((-this.digitHeight*next+this.offsetHeight));if(this.direction==Counter.ScrollDirection.Mixed){if(Math.abs(current-next)>this.characterNumber/2){if(next<current)this.beforeAnimation[i]=this.beforeAnimation[i]+this.digitHeight*this.characterNumber;else this.beforeAnimation[i]=this.beforeAnimation[i]-this.digitHeight*this.characterNumber}}else if(this.direction==Counter.ScrollDirection.Downwards){if(this.beforeAnimation[i]>this.afterAnimation[i])this.beforeAnimation[i]=this.beforeAnimation[i]-this.digitHeight*this.characterNumber}else if(this.direction==Counter.ScrollDirection.Upwards){if(this.beforeAnimation[i]<this.afterAnimation[i])this.beforeAnimation[i]=this.beforeAnimation[i]+this.digitHeight*this.characterNumber}}if(this.scrollAnimation==Counter.ScrollAnimation.FixedSpeed){var maxDistance=0.0;for(i=0;i<this.beforeAnimation.length;i++)if(Math.abs(this.beforeAnimation[i]-this.afterAnimation[i])>maxDistance)maxDistance=Math.abs(this.beforeAnimation[i]-this.afterAnimation[i]);for(i=0;i<this.beforeAnimation.length;i++){this.itemAnimationProgress[i]=Math.abs(this.beforeAnimation[i]-this.afterAnimation[i])/maxDistance}}this.value=newValue;if(this.onValueChanged!=null)this.onValueChanged();if(!(duration&&parseInt(duration)>0))duration=1000;this.isAnimating=true;var stepDuration=this.animationDuration;this.animationStep=(stepDuration/duration);this.animationProgress=0.0;var that=this;if(duration>stepDuration)this.intervalTimerId=setInterval(function(){that.animate(false)},stepDuration);this.timeoutTimerId=setTimeout(function(){that.animate(true)},duration)};Counter._parseInt=function(val){var ret=parseInt(val);if(isNaN(ret))ret=0;return ret};Counter._elementCurrentStyle=function(element,styleName){if(element.currentStyle){var i=0,temp="",changeCase=false;for(i=0;i<styleName.length;i++){if(styleName.charAt(i)&&(styleName.charAt(i)!='-'||styleName.charAt(i).toString()!='-')){if(styleName.charAt(i).toString){temp=temp+(changeCase?styleName.charAt(i).toString().toUpperCase():styleName.charAt(i).toString())}else{temp=temp+(changeCase?styleName.charAt(i).toUpperCase():styleName.charAt(i))}changeCase=false}else{changeCase=true}}styleName=temp;return element.currentStyle[styleName]}else{return getComputedStyle(element,null).getPropertyValue(styleName)}};